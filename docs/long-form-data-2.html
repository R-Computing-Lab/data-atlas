<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Long Form Data | Data Atlas</title>
  <meta name="description" content="7 Long Form Data | Data Atlas" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Long Form Data | Data Atlas" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://R-Computing-Lab/data-atlas/assets/logo.png" />
  <meta property="og:description" content="7 Long Form Data | Data Atlas" />
  <meta name="github-repo" content="R-Computing-Lab/data-atlas" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Long Form Data | Data Atlas" />
  <meta name="twitter:site" content="@smasongarrison" />
  <meta name="twitter:description" content="7 Long Form Data | Data Atlas" />
  <meta name="twitter:image" content="https://R-Computing-Lab/data-atlas/assets/logo.png" />

<meta name="author" content="S. Mason Garrison" />


<meta name="date" content="2024-06-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/favicon.ico" type="image/x-icon" />
<link rel="prev" href="long-form-data-1.html"/>
<link rel="next" href="final-words.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.33/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<html>

  <head>
  <script src="anchor-links.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GL8GKDDW8C"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-GL8GKDDW8C');
</script>

</head>

</html>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/logo.png" style="border-radius: 00%;" ></a></li>

<li class="divider"></li>
<li class="part"><span><b>Front Matter</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#how-to-use-these-notes"><i class="fa fa-check"></i>How to use these notes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="attribution.html"><a href="attribution.html"><i class="fa fa-check"></i>Attribution</a>
<ul>
<li class="chapter" data-level="" data-path="attribution.html"><a href="attribution.html#major-attributions"><i class="fa fa-check"></i>Major Attributions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="license.html"><a href="license.html"><i class="fa fa-check"></i>License</a></li>
<li class="chapter" data-level="" data-path="colophon.html"><a href="colophon.html"><i class="fa fa-check"></i>Colophon</a></li>
<li class="part"><span><b>Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="crash-course-on-the-tidyverse.html"><a href="crash-course-on-the-tidyverse.html"><i class="fa fa-check"></i><b>1</b> Crash Course on the Tidyverse</a>
<ul>
<li class="chapter" data-level="1.1" data-path="crash-course-on-the-tidyverse.html"><a href="crash-course-on-the-tidyverse.html#what-is-the-tidyverse"><i class="fa fa-check"></i><b>1.1</b> What is the Tidyverse?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="crash-course-on-the-tidyverse.html"><a href="crash-course-on-the-tidyverse.html#tidy-data"><i class="fa fa-check"></i><b>1.1.1</b> Tidy data</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="crash-course-on-the-tidyverse.html"><a href="crash-course-on-the-tidyverse.html#whats-the-difference-between-base-r-and-the-tidyverse"><i class="fa fa-check"></i><b>1.2</b> What’s the Difference between Base R and the Tidyverse?</a></li>
<li class="chapter" data-level="1.3" data-path="crash-course-on-the-tidyverse.html"><a href="crash-course-on-the-tidyverse.html#introduction-to-ggplot2"><i class="fa fa-check"></i><b>1.3</b> Introduction to ggplot2</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="crash-course-on-the-tidyverse.html"><a href="crash-course-on-the-tidyverse.html#understanding-ggplot2s-grammar-of-graphics"><i class="fa fa-check"></i><b>1.3.1</b> Understanding ggplot2’s Grammar of Graphics</a></li>
<li class="chapter" data-level="1.3.2" data-path="crash-course-on-the-tidyverse.html"><a href="crash-course-on-the-tidyverse.html#case-study-visualizing-twin-data"><i class="fa fa-check"></i><b>1.3.2</b> Case Study: Visualizing Twin Data</a></li>
<li class="chapter" data-level="1.3.3" data-path="crash-course-on-the-tidyverse.html"><a href="crash-course-on-the-tidyverse.html#key-components-of-a-ggplot2-plot"><i class="fa fa-check"></i><b>1.3.3</b> Key Components of a ggplot2 Plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tidyverse-crash-course.html"><a href="tidyverse-crash-course.html"><i class="fa fa-check"></i><b>2</b> Tidyverse Crash Course</a></li>
<li class="part"><span><b>Descriptive Statistics</b></span></li>
<li class="chapter" data-level="3" data-path="wide-form-data.html"><a href="wide-form-data.html"><i class="fa fa-check"></i><b>3</b> Wide Form Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="wide-form-data.html"><a href="wide-form-data.html#import-data"><i class="fa fa-check"></i><b>3.1</b> Import Data</a></li>
<li class="chapter" data-level="3.2" data-path="wide-form-data.html"><a href="wide-form-data.html#data-structure"><i class="fa fa-check"></i><b>3.2</b> Data Structure</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="wide-form-data.html"><a href="wide-form-data.html#annotated-explainaton-for-the-code-snippet-above"><i class="fa fa-check"></i><b>3.2.1</b> Annotated explainaton for the code snippet above:</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="wide-form-data.html"><a href="wide-form-data.html#summary-statistics-wide-form"><i class="fa fa-check"></i><b>3.3</b> Summary Statistics (Wide Form)</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="wide-form-data.html"><a href="wide-form-data.html#numeric-variables"><i class="fa fa-check"></i><b>3.3.1</b> Numeric Variables</a></li>
<li class="chapter" data-level="3.3.2" data-path="wide-form-data.html"><a href="wide-form-data.html#frequency-tables"><i class="fa fa-check"></i><b>3.3.2</b> Frequency Tables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="wide-form-data-visualization.html"><a href="wide-form-data-visualization.html"><i class="fa fa-check"></i><b>4</b> Wide Form Data Visualization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="wide-form-data-visualization.html"><a href="wide-form-data-visualization.html#plots"><i class="fa fa-check"></i><b>4.1</b> Plots</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="wide-form-data-visualization.html"><a href="wide-form-data-visualization.html#histograms-and-scatter-plots"><i class="fa fa-check"></i><b>4.1.1</b> Histograms and Scatter Plots</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="wide-form-data-visualization.html"><a href="wide-form-data-visualization.html#correlation-matries-and-correlograms"><i class="fa fa-check"></i><b>4.2</b> Correlation Matries and Correlograms</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="long-form-data.html"><a href="long-form-data.html"><i class="fa fa-check"></i><b>5</b> Long Form Data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="long-form-data.html"><a href="long-form-data.html#converting-from-wide-to-long-form"><i class="fa fa-check"></i><b>5.1</b> Converting from Wide to Long Form</a></li>
<li class="chapter" data-level="5.2" data-path="long-form-data.html"><a href="long-form-data.html#data-structure-1"><i class="fa fa-check"></i><b>5.2</b> Data Structure</a></li>
<li class="chapter" data-level="5.3" data-path="long-form-data.html"><a href="long-form-data.html#adding-sex-and-zyg"><i class="fa fa-check"></i><b>5.3</b> Adding <code>sex</code> and <code>zyg</code></a></li>
<li class="chapter" data-level="5.4" data-path="long-form-data.html"><a href="long-form-data.html#summary-statistics-long-form"><i class="fa fa-check"></i><b>5.4</b> Summary Statistics (Long Form)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="long-form-data-1.html"><a href="long-form-data-1.html"><i class="fa fa-check"></i><b>6</b> Long Form Data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="long-form-data-1.html"><a href="long-form-data-1.html#converting-from-wide-to-long-form-1"><i class="fa fa-check"></i><b>6.1</b> Converting from Wide to Long Form</a></li>
<li class="chapter" data-level="6.2" data-path="long-form-data-1.html"><a href="long-form-data-1.html#data-structure-2"><i class="fa fa-check"></i><b>6.2</b> Data Structure</a></li>
<li class="chapter" data-level="6.3" data-path="long-form-data-1.html"><a href="long-form-data-1.html#adding-sex-and-zyg-1"><i class="fa fa-check"></i><b>6.3</b> Adding <code>sex</code> and <code>zyg</code></a></li>
<li class="chapter" data-level="6.4" data-path="long-form-data-1.html"><a href="long-form-data-1.html#summary-statistics-long-form-1"><i class="fa fa-check"></i><b>6.4</b> Summary Statistics (Long Form)</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="long-form-data-2.html"><a href="long-form-data-2.html"><i class="fa fa-check"></i><b>7</b> Long Form Data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="long-form-data-2.html"><a href="long-form-data-2.html#converting-from-wide-to-long-form-2"><i class="fa fa-check"></i><b>7.1</b> Converting from Wide to Long Form</a></li>
<li class="chapter" data-level="7.2" data-path="long-form-data-2.html"><a href="long-form-data-2.html#data-structure-3"><i class="fa fa-check"></i><b>7.2</b> Data Structure</a></li>
<li class="chapter" data-level="7.3" data-path="long-form-data-2.html"><a href="long-form-data-2.html#adding-sex-and-zyg-2"><i class="fa fa-check"></i><b>7.3</b> Adding <code>sex</code> and <code>zyg</code></a></li>
<li class="chapter" data-level="7.4" data-path="long-form-data-2.html"><a href="long-form-data-2.html#summary-statistics-long-form-2"><i class="fa fa-check"></i><b>7.4</b> Summary Statistics (Long Form)</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>8</b> Final Words</a></li>
<li class="chapter" data-level="9" data-path="long-form-data-3.html"><a href="long-form-data-3.html"><i class="fa fa-check"></i><b>9</b> Long Form Data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="long-form-data-3.html"><a href="long-form-data-3.html#converting-from-wide-to-long-form-3"><i class="fa fa-check"></i><b>9.1</b> Converting from Wide to Long Form</a></li>
<li class="chapter" data-level="9.2" data-path="long-form-data-3.html"><a href="long-form-data-3.html#data-structure-4"><i class="fa fa-check"></i><b>9.2</b> Data Structure</a></li>
<li class="chapter" data-level="9.3" data-path="long-form-data-3.html"><a href="long-form-data-3.html#adding-sex-and-zyg-3"><i class="fa fa-check"></i><b>9.3</b> Adding <code>sex</code> and <code>zyg</code></a></li>
<li class="chapter" data-level="9.4" data-path="long-form-data-3.html"><a href="long-form-data-3.html#summary-statistics-long-form-3"><i class="fa fa-check"></i><b>9.4</b> Summary Statistics (Long Form)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><center>
  <a rel="license" href="./license.html">
    License: CC-BY-SA<br>
    <i class = "fab fa-creative-commons fa-2x"></i>
    <i class = "fab fa-creative-commons-by fa-2x"></i>
    <i class = "fab fa-creative-commons-sa fa-2x"></i>
  </a>
</center></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Atlas</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="long-form-data-2" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">7</span> Long Form Data<a href="long-form-data-2.html#long-form-data-2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In contrast to wide form data, long form data, also known as “tidy data,” structures datasets where each row represents a single observation, and each column represents a variable. This format is highly beneficial for statistical modeling and data analysis because it simplifies the application of various data manipulation and analysis functions. As before, we’ll use the <code>twinData</code> dataset from the <code>OpenMx</code> package, but we’ll convert it to long form to illustrate handling and analyzing data in this format.</p>
<div id="converting-from-wide-to-long-form-2" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Converting from Wide to Long Form<a href="long-form-data-2.html#converting-from-wide-to-long-form-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="long-form-data-2.html#cb94-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb94-2"><a href="long-form-data-2.html#cb94-2" tabindex="-1"></a><span class="fu">library</span>(NlsyLinks)</span>
<span id="cb94-3"><a href="long-form-data-2.html#cb94-3" tabindex="-1"></a><span class="fu">library</span>(discord)</span>
<span id="cb94-4"><a href="long-form-data-2.html#cb94-4" tabindex="-1"></a><span class="fu">library</span>(BGmisc)</span>
<span id="cb94-5"><a href="long-form-data-2.html#cb94-5" tabindex="-1"></a><span class="fu">library</span>(OpenMx)</span>
<span id="cb94-6"><a href="long-form-data-2.html#cb94-6" tabindex="-1"></a><span class="fu">library</span>(conflicted) <span class="co"># to handle conflicts</span></span>
<span id="cb94-7"><a href="long-form-data-2.html#cb94-7" tabindex="-1"></a>conflicted<span class="sc">::</span><span class="fu">conflicts_prefer</span>(OpenMx<span class="sc">::</span>vech,dplyr<span class="sc">::</span>filter) <span class="co"># Resolve conflicts</span></span>
<span id="cb94-8"><a href="long-form-data-2.html#cb94-8" tabindex="-1"></a></span>
<span id="cb94-9"><a href="long-form-data-2.html#cb94-9" tabindex="-1"></a></span>
<span id="cb94-10"><a href="long-form-data-2.html#cb94-10" tabindex="-1"></a><span class="fu">data</span>(twinData)</span>
<span id="cb94-11"><a href="long-form-data-2.html#cb94-11" tabindex="-1"></a></span>
<span id="cb94-12"><a href="long-form-data-2.html#cb94-12" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> twinData <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>age)</span></code></pre></div>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="long-form-data-2.html#cb95-1" tabindex="-1"></a><span class="co"># Convert wide data to long form</span></span>
<span id="cb95-2"><a href="long-form-data-2.html#cb95-2" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> df_long <span class="sc">%&gt;%</span></span>
<span id="cb95-3"><a href="long-form-data-2.html#cb95-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb95-4"><a href="long-form-data-2.html#cb95-4" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">matches</span>(<span class="st">&#39;1$|2$&#39;</span>), <span class="co"># Select columns ending in &#39;1&#39; or &#39;2&#39;</span></span>
<span id="cb95-5"><a href="long-form-data-2.html#cb95-5" tabindex="-1"></a>     <span class="at">cols_vary =</span> <span class="st">&quot;slowest&quot;</span>, <span class="co"># Specify that the columns are in the same order for each twin</span></span>
<span id="cb95-6"><a href="long-form-data-2.html#cb95-6" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;.value&quot;</span>, <span class="st">&quot;twin&quot;</span>), <span class="co"># Split the column names into variable and twin number</span></span>
<span id="cb95-7"><a href="long-form-data-2.html#cb95-7" tabindex="-1"></a>    <span class="at">names_pattern =</span> <span class="st">&quot;(.*)(1|2)&quot;</span> <span class="co"># Capture the variable and twin number</span></span>
<span id="cb95-8"><a href="long-form-data-2.html#cb95-8" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div id="data-structure-3" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Data Structure<a href="long-form-data-2.html#data-structure-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s take a look at the structure of the dataset now that it’s in long form.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="long-form-data-2.html#cb96-1" tabindex="-1"></a><span class="fu">class</span>(df_long)</span></code></pre></div>
<pre><code>## [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="long-form-data-2.html#cb98-1" tabindex="-1"></a><span class="fu">glimpse</span>(df_long)</span></code></pre></div>
<pre><code>## Rows: 7,616
## Columns: 11
## $ fam      &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18…
## $ zyg      &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ part     &lt;int&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2…
## $ cohort   &lt;chr&gt; &quot;younger&quot;, &quot;younger&quot;, &quot;younger&quot;, &quot;younger&quot;, &quot;younger&quot;, &quot;young…
## $ zygosity &lt;fct&gt; MZFF, MZFF, MZFF, MZFF, MZFF, MZFF, MZFF, MZFF, MZFF, MZFF, M…
## $ twin     &lt;chr&gt; &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;…
## $ wt       &lt;int&gt; 58, 54, 55, 66, 50, 60, 65, 40, 60, 76, 48, 70, 51, 53, 58, 4…
## $ ht       &lt;dbl&gt; 1.7000, 1.6299, 1.6499, 1.5698, 1.6099, 1.5999, 1.7500, 1.559…
## $ htwt     &lt;dbl&gt; 20.0692, 20.3244, 20.2020, 26.7759, 19.2894, 23.4375, 21.2245…
## $ bmi      &lt;dbl&gt; 20.9943, 21.0828, 21.0405, 23.0125, 20.7169, 22.0804, 21.3861…
## $ age      &lt;int&gt; 21, 24, 21, 21, 19, 26, 23, 29, 24, 28, 29, 19, 23, 22, 23, 2…</code></pre>
<p>The dataset now contains a much larger number of observations, as each twin’s data is represented as a separate row. The zygosity variable indicates the zygosity of the twins, while other variables are split into variable and value pairs, reflecting measurements or characteristics of the twins.</p>
</div>
<div id="adding-sex-and-zyg-2" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Adding <code>sex</code> and <code>zyg</code><a href="long-form-data-2.html#adding-sex-and-zyg-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To facilitate analyses that depend on sex or zygosity type, we’ll add these as new columns derived from zygosity.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="long-form-data-2.html#cb100-1" tabindex="-1"></a><span class="co"># Add &#39;sex&#39; and &#39;zyg&#39; columns based on &#39;zygosity&#39;</span></span>
<span id="cb100-2"><a href="long-form-data-2.html#cb100-2" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> df_long <span class="sc">%&gt;%</span></span>
<span id="cb100-3"><a href="long-form-data-2.html#cb100-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex =</span> <span class="fu">case_when</span>(</span>
<span id="cb100-4"><a href="long-form-data-2.html#cb100-4" tabindex="-1"></a>    zygosity <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;MZFF&quot;</span>, <span class="st">&quot;DZFF&quot;</span>) <span class="sc">~</span> <span class="st">&quot;F&quot;</span>,</span>
<span id="cb100-5"><a href="long-form-data-2.html#cb100-5" tabindex="-1"></a>    zygosity <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;MZMM&quot;</span>, <span class="st">&quot;DZMM&quot;</span>) <span class="sc">~</span> <span class="st">&quot;M&quot;</span>,</span>
<span id="cb100-6"><a href="long-form-data-2.html#cb100-6" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;OS&quot;</span></span>
<span id="cb100-7"><a href="long-form-data-2.html#cb100-7" tabindex="-1"></a>  ),</span>
<span id="cb100-8"><a href="long-form-data-2.html#cb100-8" tabindex="-1"></a>  <span class="at">zyg =</span> <span class="fu">case_when</span>(</span>
<span id="cb100-9"><a href="long-form-data-2.html#cb100-9" tabindex="-1"></a>    zygosity <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;MZFF&quot;</span>, <span class="st">&quot;MZMM&quot;</span>) <span class="sc">~</span> <span class="st">&quot;MZ&quot;</span>,</span>
<span id="cb100-10"><a href="long-form-data-2.html#cb100-10" tabindex="-1"></a>    zygosity <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;DZFF&quot;</span>, <span class="st">&quot;DZMM&quot;</span>, <span class="st">&quot;DZOS&quot;</span>) <span class="sc">~</span> <span class="st">&quot;DZ&quot;</span>,</span>
<span id="cb100-11"><a href="long-form-data-2.html#cb100-11" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb100-12"><a href="long-form-data-2.html#cb100-12" tabindex="-1"></a>  ))</span></code></pre></div>
<p>Unfortunately, the data do not contain the information for the gender for each twin, so we will just have to settle for noting that the data is missing.</p>
</div>
<div id="summary-statistics-long-form-2" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Summary Statistics (Long Form)<a href="long-form-data-2.html#summary-statistics-long-form-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Once again, let’s calculate summary statistics for numeric variables across the full sample. This will provide a quick overview of central tendencies and variability in the dataset. When working with long form data, it is often helpful to start with summarizing by the data structure you already have. In this case, we will calculate summary statistics by specific measurement across all twins.</p>
<p>Data Structure and Summary Statistics
Examine the transformed data and calculate summary statistics similar to those performed in the wide form.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="long-form-data-2.html#cb101-1" tabindex="-1"></a>summary_stats_long <span class="ot">&lt;-</span> df_long <span class="sc">%&gt;%</span></span>
<span id="cb101-2"><a href="long-form-data-2.html#cb101-2" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="fu">list</span>(</span>
<span id="cb101-3"><a href="long-form-data-2.html#cb101-3" tabindex="-1"></a>    <span class="at">mean =</span> <span class="sc">~</span><span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb101-4"><a href="long-form-data-2.html#cb101-4" tabindex="-1"></a>    <span class="at">sd =</span> <span class="sc">~</span><span class="fu">sd</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb101-5"><a href="long-form-data-2.html#cb101-5" tabindex="-1"></a>    <span class="at">median =</span> <span class="sc">~</span><span class="fu">median</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb101-6"><a href="long-form-data-2.html#cb101-6" tabindex="-1"></a>    <span class="at">min =</span> <span class="sc">~</span><span class="fu">min</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb101-7"><a href="long-form-data-2.html#cb101-7" tabindex="-1"></a>    <span class="at">max =</span> <span class="sc">~</span><span class="fu">max</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb101-8"><a href="long-form-data-2.html#cb101-8" tabindex="-1"></a>    <span class="at">IQR =</span> <span class="sc">~</span><span class="fu">IQR</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb101-9"><a href="long-form-data-2.html#cb101-9" tabindex="-1"></a>  ), <span class="at">.names =</span> <span class="st">&quot;{col}_{fn}&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb101-10"><a href="long-form-data-2.html#cb101-10" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb101-11"><a href="long-form-data-2.html#cb101-11" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">everything</span>(),</span>
<span id="cb101-12"><a href="long-form-data-2.html#cb101-12" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;variable&quot;</span>, <span class="st">&quot;statistic&quot;</span>),</span>
<span id="cb101-13"><a href="long-form-data-2.html#cb101-13" tabindex="-1"></a>    <span class="at">names_sep =</span> <span class="st">&quot;_&quot;</span></span>
<span id="cb101-14"><a href="long-form-data-2.html#cb101-14" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb101-15"><a href="long-form-data-2.html#cb101-15" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb101-16"><a href="long-form-data-2.html#cb101-16" tabindex="-1"></a>    <span class="at">names_from =</span> statistic,</span>
<span id="cb101-17"><a href="long-form-data-2.html#cb101-17" tabindex="-1"></a>    <span class="at">values_from =</span> value</span>
<span id="cb101-18"><a href="long-form-data-2.html#cb101-18" tabindex="-1"></a>  )</span>
<span id="cb101-19"><a href="long-form-data-2.html#cb101-19" tabindex="-1"></a></span>
<span id="cb101-20"><a href="long-form-data-2.html#cb101-20" tabindex="-1"></a>summary_stats_long <span class="sc">%&gt;%</span> </span>
<span id="cb101-21"><a href="long-form-data-2.html#cb101-21" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">15</span>) <span class="co"># to see more rows</span></span></code></pre></div>
<pre><code>## # A tibble: 7 × 7
##   variable    mean        sd  median   min     max      IQR
##   &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
## 1 fam      1904.   1099.     1904.    1    3808    1904.   
## 2 part        1.93    0.265     2     0       2       0    
## 3 wt         63.9    11.7      62    34     127      16    
## 4 ht          1.68    0.0958    1.68  1.34    1.99    0.150
## 5 htwt       22.6     3.18     22.2  13.3    46.2     3.83 
## 6 bmi        21.8     0.941    21.7  18.1    26.8     1.20 
## 7 age        34.5    14.2      30    17      88      19</code></pre>
<p>Generate frequency tables for sex and zyg, paralleling the wide form analysis.
# Frequency Tables</p>
<p>Paralleling the wide form analysis, let us create frequency tables for categorical variables like zygosity and sex. These tables should provide a clear picture of the distribution of these categories within the dataset. In some ways, these calculations are simpler in long form data because each row is already an individual observation.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="long-form-data-2.html#cb103-1" tabindex="-1"></a><span class="co"># Counting &#39;zygosity&#39; and calculating percentages</span></span>
<span id="cb103-2"><a href="long-form-data-2.html#cb103-2" tabindex="-1"></a>zygosity_summary_long <span class="ot">&lt;-</span> df_long <span class="sc">%&gt;%</span></span>
<span id="cb103-3"><a href="long-form-data-2.html#cb103-3" tabindex="-1"></a>  <span class="fu">count</span>(zyg, <span class="at">name =</span> <span class="st">&quot;count&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-4"><a href="long-form-data-2.html#cb103-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-5"><a href="long-form-data-2.html#cb103-5" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">category =</span> zyg) <span class="sc">%&gt;%</span>  <span class="co"># Renaming the column for clarity</span></span>
<span id="cb103-6"><a href="long-form-data-2.html#cb103-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="st">&quot;zygosity&quot;</span>)  <span class="co"># Adding a descriptor column for the variable</span></span>
<span id="cb103-7"><a href="long-form-data-2.html#cb103-7" tabindex="-1"></a></span>
<span id="cb103-8"><a href="long-form-data-2.html#cb103-8" tabindex="-1"></a><span class="co"># Counting &#39;sex&#39; and calculating percentages</span></span>
<span id="cb103-9"><a href="long-form-data-2.html#cb103-9" tabindex="-1"></a>sex_summary_long <span class="ot">&lt;-</span> df_long <span class="sc">%&gt;%</span></span>
<span id="cb103-10"><a href="long-form-data-2.html#cb103-10" tabindex="-1"></a>  <span class="fu">count</span>(sex, <span class="at">name =</span> <span class="st">&quot;count&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-11"><a href="long-form-data-2.html#cb103-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-12"><a href="long-form-data-2.html#cb103-12" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">category =</span> sex) <span class="sc">%&gt;%</span>  <span class="co"># Renaming the column for clarity</span></span>
<span id="cb103-13"><a href="long-form-data-2.html#cb103-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="st">&quot;sex&quot;</span>)  <span class="co"># Adding a descriptor column for the variable</span></span>
<span id="cb103-14"><a href="long-form-data-2.html#cb103-14" tabindex="-1"></a></span>
<span id="cb103-15"><a href="long-form-data-2.html#cb103-15" tabindex="-1"></a><span class="co"># Combining both summaries into a single dataframe</span></span>
<span id="cb103-16"><a href="long-form-data-2.html#cb103-16" tabindex="-1"></a>combined_summary_long <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(zygosity_summary_long, sex_summary_long) <span class="sc">%&gt;%</span></span>
<span id="cb103-17"><a href="long-form-data-2.html#cb103-17" tabindex="-1"></a>  <span class="fu">select</span>(variable, category, <span class="fu">everything</span>())  <span class="co"># Reordering columns for clarity</span></span>
<span id="cb103-18"><a href="long-form-data-2.html#cb103-18" tabindex="-1"></a></span>
<span id="cb103-19"><a href="long-form-data-2.html#cb103-19" tabindex="-1"></a>combined_summary_long</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   variable category count percentage
##   &lt;chr&gt;    &lt;chr&gt;    &lt;int&gt;      &lt;dbl&gt;
## 1 zygosity DZ        4018       52.8
## 2 zygosity MZ        3598       47.2
## 3 sex      F         3966       52.1
## 4 sex      M         1838       24.1
## 5 sex      OS        1812       23.8</code></pre>
<p>As you can see, the long form data structure allows for a straightforward calculation of frequency tables for categorical variables. The resulting tables provide a clear picture of the distribution, and it does not differ from the wide form analysis, as long as one remembers to that we’re now looking at individual twins rather than pairs.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="long-form-data-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="final-words.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/R-Computing-Lab/data-atlas/edit/main/06_pathdiagrams.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["https://github.com/R-Computing-Lab/data-atlas/raw/main/06_pathdiagrams.Rmd"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
