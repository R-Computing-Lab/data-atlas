<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Data Atlas</title>
  <meta name="description" content="Data Atlas" />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="Data Atlas" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://R-Computing-Lab/data-atlas/assets/logo.png" />
  <meta property="og:description" content="Data Atlas" />
  <meta name="github-repo" content="R-Computing-Lab/data-atlas" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Data Atlas" />
  <meta name="twitter:site" content="@smasongarrison" />
  <meta name="twitter:description" content="Data Atlas" />
  <meta name="twitter:image" content="https://R-Computing-Lab/data-atlas/assets/logo.png" />

<meta name="author" content="S. Mason Garrison" />


<meta name="date" content="2024-06-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/favicon.ico" type="image/x-icon" />
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.33/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<html>

  <head>
  <script src="anchor-links.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GL8GKDDW8C"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-GL8GKDDW8C');
</script>

</head>

</html>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="assets/style.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">Data Atlas</h1>
<p class="author"><em>S. Mason Garrison</em></p>
<p class="date"><em>2024-06-18</em></p>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#part-front-matter" id="toc-part-front-matter">(PART*) Front Matter</a></li>
<li><a href="#abstract" id="toc-abstract">Abstract</a></li>
<li><a href="#preface" id="toc-preface">Preface</a>
<ul>
<li><a href="#how-to-use-these-notes" id="toc-how-to-use-these-notes">How to use these notes</a></li>
</ul></li>
<li><a href="#attribution" id="toc-attribution">Attribution</a>
<ul>
<li><a href="#major-attributions" id="toc-major-attributions">Major Attributions</a></li>
</ul></li>
<li><a href="#license" id="toc-license">License</a></li>
<li><a href="#colophon" id="toc-colophon">Colophon</a></li>
<li><a href="#part-introduction" id="toc-part-introduction">(PART*) Introduction</a></li>
<li><a href="#introduction-to-ggplot2" id="toc-introduction-to-ggplot2"><span class="toc-section-number">1</span> Introduction to ggplot2</a>
<ul>
<li><a href="#understanding-ggplot2s-grammar-of-graphics" id="toc-understanding-ggplot2s-grammar-of-graphics"><span class="toc-section-number">1.1</span> Understanding ggplot2’s Grammar of Graphics</a></li>
<li><a href="#case-study-visualizing-twin-data" id="toc-case-study-visualizing-twin-data"><span class="toc-section-number">1.2</span> Case Study: Visualizing Twin Data</a>
<ul>
<li><a href="#plot-development-stages" id="toc-plot-development-stages"><span class="toc-section-number">1.2.1</span> Plot Development Stages</a></li>
</ul></li>
</ul></li>
<li><a href="#welcome-to-ggplot" id="toc-welcome-to-ggplot"><span class="toc-section-number">2</span> Welcome to ggplot</a>
<ul>
<li><a href="#math-example" id="toc-math-example"><span class="toc-section-number">2.1</span> math example</a></li>
</ul></li>
<li><a href="#descriptives-wide" id="toc-descriptives-wide"><span class="toc-section-number">3</span> Descriptives (Wide)</a>
<ul>
<li><a href="#import-data" id="toc-import-data"><span class="toc-section-number">3.1</span> Import Data</a></li>
<li><a href="#data-structure" id="toc-data-structure"><span class="toc-section-number">3.2</span> Data Structure</a></li>
<li><a href="#summary-statistics" id="toc-summary-statistics"><span class="toc-section-number">3.3</span> Summary Statistics</a>
<ul>
<li><a href="#numeric-variables" id="toc-numeric-variables"><span class="toc-section-number">3.3.1</span> Numeric Variables</a></li>
</ul></li>
<li><a href="#frequency-tables" id="toc-frequency-tables"><span class="toc-section-number">3.4</span> Frequency Tables</a></li>
<li><a href="#plots" id="toc-plots"><span class="toc-section-number">3.5</span> Plots</a></li>
<li><a href="#correlation-matrix" id="toc-correlation-matrix"><span class="toc-section-number">3.6</span> Correlation Matrix</a></li>
</ul></li>
<li><a href="#applications" id="toc-applications"><span class="toc-section-number">4</span> Applications</a>
<ul>
<li><a href="#example-one" id="toc-example-one"><span class="toc-section-number">4.1</span> Example one</a></li>
<li><a href="#example-two" id="toc-example-two"><span class="toc-section-number">4.2</span> Example two</a></li>
</ul></li>
<li><a href="#final-words" id="toc-final-words"><span class="toc-section-number">5</span> Final Words</a></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Atlas</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="part-front-matter" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART*) Front Matter<a href="#part-front-matter" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="abstract" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">Abstract<a href="#abstract" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The adage ‘A picture is worth a thousand words’ is just as applicable to Behavior Genetics as it is to journalism. In this talk, I delve into the rich diverse history of data visualization techniques in the field of behavior genetics, tracing advancements from Wright’s <span class="citation">(<a href="#ref-Wright1920">Wright 1920</a>)</span> classic path diagram of guinea pigs to the contemporary usage of Manhattan plots. This survey sets the stage for the development of two resources aimed at bolstering the field’s visualization toolkit. The first, an atlas employing ‘ggplot2’ in R, aims to guide researchers in selecting the most appropriate visualization techniques for their data. The second, a proposed R package, seeks to facilitate the integration of ‘OpenMx’-compatible visualizations, streamlining the presentation of complex genetic analyses. Emphasizing practical advice, the talk will cover effective uses of path diagrams, family trees, and interaction visualizations, with the goal of improving clarity and interpretability of genetic data. This initiative aspires to democratize advanced data visualization tools, making them more accessible to the behavior genetics community and, in turn, amplifying the impact and reach of its research.</p>
</div>
<div id="preface" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">Preface<a href="#preface" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In the dynamic field of behavior genetics, the ability to visualize complex data clearly and effectively is not just a technical skill but a narrative art. This document, accompanying the talk on the historical and innovative approaches to data visualization in behavior genetics, introduces the fundamentals of employing ggplot2, a powerful and versatile package in R for creating quality graphics.</p>
<p><code>ggplot2</code> is part of the <code>tidyverse</code>, an opinionated collection of <code>R</code> packages designed for data science that share an underlying design philosophy, grammar, and data structures. At the heart of <code>ggplot2</code> is the concept of a layered grammar of graphics, which allows users to create graphics in a step-by-step, clear and logical way. This framework not only simplifies plotting complex data but also encourages a deeper understanding of the graphical representation itself—making it an ideal tool for behavior geneticists seeking to unvail the hidden stories within their data.</p>
<p>The Data Atlas presented here is designed to serve as a practical guide through the landscape of data visualization techniques specific to the field of behavior genetics. It offers a curated selection of graphical methods that range from the foundational, such as Wright’s classic path diagrams, to the advanced, like the interaction visualizations and Manhattan plots, which have become indispensable in the modern geneticist’s toolkit.</p>
<p>Further, this document and the accompanying talk address the development of an innovative R package tailored to integrate with <a href="https://openmx.ssri.psu.edu/">OpenMx</a> and <a href="https://r-computing-lab.github.io/BGmisc/">BGmisic</a>, projects aimed at facilitating advanced statistical modeling of complex genetic data. This package is proposed to enhance the <code>ggplot2</code> environment, making it more conducive to the specialized needs of behavior genetics research—such as the visualization of path diagrams and family trees that are not only informative but are also aesthetically compelling.</p>
<p>As we proceed, this introduction will delve into the specifics of ggplot2 usage in R, demonstrating how this tool can be adapted to meet the unique challenges of visualizing behavioral and genetic data. By bridging the gap between traditional methods and contemporary demands, the resources developed aim to democratize advanced data visualization tools, thereby expanding the accessibility and impact of behavior genetics research.</p>
<!--chapter:end:index.Rmd-->
<!-- front page -->
<div id="how-to-use-these-notes" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">How to use these notes<a href="#how-to-use-these-notes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To navigate these notes, use the table of contents on the left side of the screen. You can open or close the table of contents using the hamburger icon (horizontal bars) at the top of the document. Additionally, there are other icons at the top of the document for searching within the text, and for adjusting the size, font, or color scheme of the page. The document will be updated unpredictably.</p>
</div>
</div>
<div id="attribution" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">Attribution<a href="#attribution" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>These notes lean heavily on other peoples’ materials and ideas. I have done my best to document the origin of the materials and ideas. In particular, I have noted people whose work has been a major contribution as well as those who have additional contributions. You can see specific changes by examining the <a href="https://github.com/R-Computing-Lab/data-atlas/commits/main">edit history on the git repo</a></p>
<div id="major-attributions" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Major Attributions<a href="#major-attributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Jenny Bryan’s (<a href="https://jennybryan.org">jennybryan.org</a>) <a href="https://stat545.com">STAT 545</a> and <a href="https://happygitwithr.com/">Happy Git with R</a>;</li>
<li>Mason Garrison’s PSY 720 <a href="https://datascience4psych.github.io/DataScience4Psych/">Data Science for Psychologists</a></li>
</ul>
</div>
</div>
<div id="license" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">License<a href="#license" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This work is licensed under a <a href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p>
<center>
<i class="fab fa-creative-commons fa-2x"></i><i class="fab fa-creative-commons-by fa-2x"></i><i class="fab fa-creative-commons-sa fa-2x"></i>
</center>
<p><em>This information is a human-readable summary of (and not a substitute for) the license. Please see <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode" class="uri">https://creativecommons.org/licenses/by-sa/4.0/legalcode</a> for the full legal text.</em></p>
<p><strong>You are free to:</strong></p>
<ul>
<li><p><strong>Share</strong>—copy and redistribute the material in any medium or format</p></li>
<li><p><strong>Remix</strong>—remix, transform, and build upon the material for any purpose, even commercially.</p></li>
</ul>
<p>The licensor cannot revoke these freedoms as long as you follow the license terms.</p>
<p><strong>Under the following terms:</strong></p>
<ul>
<li><p><strong>Attribution</strong>—You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use.</p></li>
<li><p><strong>ShareAlike</strong>—If you remix, transform, or build upon the material, you must distribute your contributions under the same license as the original.</p></li>
<li><p><strong>No additional restrictions</strong>—You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits.</p></li>
</ul>
<p><strong>Notices:</strong></p>
<p>You do not have to comply with the license for elements of the material in the public domain or where your use is permitted by an applicable exception or limitation.</p>
<p>No warranties are given. The license may not give you all of the permissions necessary for your intended use. For example, other rights such as publicity, privacy, or moral rights may limit how you use the material.</p>
</div>
<div id="colophon" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">Colophon<a href="#colophon" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>These notes was written in <a href="http://bookdown.org/">bookdown</a> inside <a href="http://www.rstudio.com/ide/">RStudio</a>. The <a href="https://R-Computing-Lab.github.io/data-atlas">website</a> is hosted with <a href="https://www.github.com">github</a>. The complete source is available from <a href="https://github.com/R-Computing-Lab/data-atlas">github</a>.</p>
<p>The book style was designed by <a href="https://desiree.rbind.io/">Desirée De Leon</a>.</p>
<p>This version of the notes was built with:</p>
<pre><code>## Finding R package dependencies ... Done!</code></pre>
<pre><code>##  setting  value
##  version  R version 4.4.1 (2024-06-14 ucrt)
##  os       Windows 11 x64 (build 22635)
##  system   x86_64, mingw32
##  ui       RTerm
##  language (EN)
##  collate  English_United States.utf8
##  ctype    English_United States.utf8
##  tz       America/New_York
##  date     2024-06-18
##  pandoc   3.1.11 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)</code></pre>
<p>Along with these packages:</p>
<div class="datatables html-widget html-fill-item" id="htmlwidget-ab75b59efa20265b019b" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ab75b59efa20265b019b">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["base64enc","bookdown","bslib","cachem","cli","digest","evaluate","fastmap","fontawesome","fs","glue","highr","htmltools","jquerylib","jsonlite","knitr","lifecycle","memoise","mime","R6","rappdirs","rlang","rmarkdown","sass","tinytex","xfun","yaml"],[null,"0.39","0.7.0","1.1.0","3.6.2","0.6.35","0.23","1.2.0",null,"1.6.4","1.7.0",null,"0.5.8.1","0.1.4","1.8.8","1.46","1.0.4","2.0.1","0.12","2.5.1",null,"1.1.3","2.27","0.4.9",null,"0.44","2.3.8"],["2015-07-28","2024-04-15","2024-03-29","2024-05-16","2023-12-11","2024-03-11","2023-11-01","2024-05-15","2023-08-19","2024-04-25","2024-01-09","2024-05-26","2024-04-04","2021-04-26","2023-12-04","2024-04-06","2023-11-07","2021-11-26","2021-09-28","2021-08-19","2021-01-31","2024-01-10","2024-05-17","2024-03-15","2024-05-06","2024-05-15","2023-12-11"],["CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)","CRAN (R 4.4.0)"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th>package<\/th>\n      <th>loadedversion<\/th>\n      <th>date<\/th>\n      <th>source<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":27,"autoWidth":true,"bInfo":false,"paging":false,"columnDefs":[{"name":"package","targets":0},{"name":"loadedversion","targets":1},{"name":"date","targets":2},{"name":"source","targets":3}],"order":[],"orderClasses":false,"orderCellsTop":true,"lengthMenu":[10,25,27,50,100]},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<!--DS4P Links-->
<!-- https://smasongarrison.github.io/syllabi/data-science.html -->
<!--AE Links-->
<!-- Lab Links-->
<!--Slides-->
<!--externals-->
<!--chapter:end:0000_front.Rmd-->
</div>
<div id="part-introduction" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">(PART*) Introduction<a href="#part-introduction" class="anchor-section" aria-label="Anchor link to header"></a></h1>
</div>
<div id="introduction-to-ggplot2" class="section level1 hasAnchor" number="1">
<h1 class="hasAnchor"><span class="header-section-number">1</span> Introduction to ggplot2<a href="#introduction-to-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this chapter, we explore the power of <code>ggplot2</code> within the tidyverse package suite for creating compelling visual representations of twin studies in behavior genetics. <code>ggplot2</code>’s layer-oriented approach to building data visualizations allows researchers to intuitively map out the complexities inherent in twin data, providing insights that are crucial for both hypothesis testing and exploratory data analysis.</p>
<div id="understanding-ggplot2s-grammar-of-graphics" class="section level2 hasAnchor" number="1.1">
<h2 class="hasAnchor"><span class="header-section-number">1.1</span> Understanding ggplot2’s Grammar of Graphics<a href="#understanding-ggplot2s-grammar-of-graphics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>ggplot2</code> is a powerful data visualization package in R that is part of the tidyverse suite of packages. It is based on the grammar of graphics, a coherent system for describing and building visualizations. The grammar of graphics is based on the idea that a plot can be decomposed into a set of independent components, such as data, aesthetics, and geoms (geometric objects). By combining these components, ggplot2 allows for the creation of complex and informative visualizations that can be easily customized and extended.</p>
<p>The structure of the code for plots can be summarized as follows:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> [[dataset]],</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>     <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> [[x<span class="sc">-</span>variable]],</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>                   <span class="at">y =</span> [[y<span class="sc">-</span>variable]])) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>   <span class="fu">geom_xxx</span>() <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>   other options</span></code></pre></div>
<p>Each component of the plot is added in layers. The <code>ggplot()</code> function initializes the plot, <code>aes()</code> specifies the aesthetic mappings (how variables are mapped to visual properties), and <code>geom_xxx()</code> adds a geometric object (points, lines, bars, etc.) to the plot. Additional layers can be added to further customize the plot, such as labels, titles, and themes. We’ll dive into these soon enough, but first, let’s walk through a simple example to illustrate the basic structure of a ggplot2 plot.</p>
</div>
<div id="case-study-visualizing-twin-data" class="section level2 hasAnchor" number="1.2">
<h2 class="hasAnchor"><span class="header-section-number">1.2</span> Case Study: Visualizing Twin Data<a href="#case-study-visualizing-twin-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To make this more concrete, let’s consider an example using twin data on height from the <code>OpenMX</code> package, which is in the <code>twinData</code> data. These 3,808 pairs of twins are from the Australian National Health and Medical Research Council Twin Registry. The dataset contains information on the height, weight, and body mass index (BMI) of twins, along with their zygosity and other demographic information.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)  <span class="co"># Load the tidyverse packages</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">library</span>(OpenMx)    <span class="co"># Load the OpenMx package</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">library</span>(BGmisc) <span class="co"># Load the BGmisc package</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="fu">library</span>(conflicted) <span class="co"># to handle conflicts</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>conflicted<span class="sc">::</span><span class="fu">conflicts_prefer</span>(OpenMx<span class="sc">::</span>vech,dplyr<span class="sc">::</span>filter) <span class="co"># Resolve conflicts</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">data</span>(twinData)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">glimpse</span>(twinData)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt; Rows: 3,808</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; Columns: 16</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; $ fam      &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18…</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt; $ age      &lt;int&gt; 21, 24, 21, 21, 19, 26, 23, 29, 24, 28, 29, 19, 23, 22, 23, 2…</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; $ zyg      &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt; $ part     &lt;int&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2…</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt; $ wt1      &lt;int&gt; 58, 54, 55, 66, 50, 60, 65, 40, 60, 76, 48, 70, 51, 53, 58, 4…</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; $ wt2      &lt;int&gt; 57, 53, 50, 76, 48, 60, 65, 39, 57, 64, 51, 67, 51, 55, 57, 5…</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; $ ht1      &lt;dbl&gt; 1.70, 1.63, 1.65, 1.57, 1.61, 1.60, 1.75, 1.56, 1.76, 1.70, 1…</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; $ ht2      &lt;dbl&gt; 1.70, 1.63, 1.68, 1.65, 1.63, 1.57, 1.77, 1.53, 1.77, 1.73, 1…</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; $ htwt1    &lt;dbl&gt; 20.1, 20.3, 20.2, 26.8, 19.3, 23.4, 21.2, 16.4, 19.4, 26.3, 2…</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt; $ htwt2    &lt;dbl&gt; 19.7, 19.9, 17.7, 27.9, 18.1, 24.3, 20.7, 16.7, 18.2, 21.4, 2…</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; $ bmi1     &lt;dbl&gt; 21.0, 21.1, 21.0, 23.0, 20.7, 22.1, 21.4, 19.6, 20.7, 22.9, 2…</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt; $ bmi2     &lt;dbl&gt; 20.9, 21.0, 20.1, 23.3, 20.3, 22.3, 21.2, 19.7, 20.3, 21.4, 2…</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt; $ cohort   &lt;chr&gt; &quot;younger&quot;, &quot;younger&quot;, &quot;younger&quot;, &quot;younger&quot;, &quot;younger&quot;, &quot;young…</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co">#&gt; $ zygosity &lt;fct&gt; MZFF, MZFF, MZFF, MZFF, MZFF, MZFF, MZFF, MZFF, MZFF, MZFF, M…</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#&gt; $ age1     &lt;int&gt; 21, 24, 21, 21, 19, 26, 23, 29, 24, 28, 29, 19, 23, 22, 23, 2…</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#&gt; $ age2     &lt;int&gt; 21, 24, 21, 21, 19, 26, 23, 29, 24, 28, 29, 19, 23, 22, 23, 2…</span></span></code></pre></div>
<p>I’m going to tidy up the data a bit by renaming the columns and removing some unnecessary columns. I’ll also filter out any rows with missing values in the height columns. I’ve also added a column to represent the sex of the twins and their zygosity.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>twinData_cleaned <span class="ot">&lt;-</span> twinData <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="fu">rename</span>( <span class="co"># Rename columns</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>    <span class="at">family =</span> fam,</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>    <span class="at">weight_t1 =</span> wt1,</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>    <span class="at">weight_t2 =</span> wt2,</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>    <span class="at">height_t1 =</span> ht1,</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>    <span class="at">height_t2 =</span> ht2,</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>    <span class="at">bmi_t1 =</span> bmi1,</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>    <span class="at">bmi_t2 =</span> bmi2,</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>    <span class="at">age_t1 =</span> age1,</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>    <span class="at">age_t2 =</span> age2,</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>    <span class="at">heightweight_t1 =</span> htwt1,</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>    <span class="at">heightweight_t2 =</span> htwt2) <span class="sc">%&gt;%</span> </span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="co"># Remove unnecessary columns</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>    part,</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>    zyg,</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>    age_t1,</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>    age_t2)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="co"># Remove rows with missing values</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(height_t1),</span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(height_t2)) <span class="sc">%&gt;%</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="co"># Create new columns</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>    <span class="at">sex =</span> <span class="fu">case_when</span>(zygosity <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;MZFF&quot;</span>,<span class="st">&quot;DZFF&quot;</span>) <span class="sc">~</span> <span class="st">&quot;F&quot;</span>, </span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>                                zygosity <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;MZMM&quot;</span>,<span class="st">&quot;DZMM&quot;</span>) <span class="sc">~</span> <span class="st">&quot;M&quot;</span>,</span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;OS&quot;</span>),</span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>                    <span class="at">zyg =</span> <span class="fu">case_when</span>(zygosity <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;MZFF&quot;</span>,<span class="st">&quot;MZMM&quot;</span>) <span class="sc">~</span> <span class="st">&quot;MZ&quot;</span>, </span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a>                                    zygosity <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;DZFF&quot;</span>,<span class="st">&quot;DZMM&quot;</span>,<span class="st">&quot;DZOS&quot;</span>) <span class="sc">~</span> <span class="st">&quot;DZ&quot;</span>,</span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span> ))</span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a></span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a><span class="fu">glimpse</span>(twinData_cleaned)</span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a><span class="co">#&gt; Rows: 3,667</span></span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a><span class="co">#&gt; Columns: 14</span></span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a><span class="co">#&gt; $ family          &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,…</span></span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a><span class="co">#&gt; $ age             &lt;int&gt; 21, 24, 21, 21, 19, 26, 23, 29, 24, 28, 29, 19, 23, 22…</span></span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a><span class="co">#&gt; $ weight_t1       &lt;int&gt; 58, 54, 55, 66, 50, 60, 65, 40, 60, 76, 48, 70, 51, 53…</span></span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a><span class="co">#&gt; $ weight_t2       &lt;int&gt; 57, 53, 50, 76, 48, 60, 65, 39, 57, 64, 51, 67, 51, 55…</span></span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a><span class="co">#&gt; $ height_t1       &lt;dbl&gt; 1.70, 1.63, 1.65, 1.57, 1.61, 1.60, 1.75, 1.56, 1.76, …</span></span>
<span id="cb6-38"><a href="#cb6-38" tabindex="-1"></a><span class="co">#&gt; $ height_t2       &lt;dbl&gt; 1.70, 1.63, 1.68, 1.65, 1.63, 1.57, 1.77, 1.53, 1.77, …</span></span>
<span id="cb6-39"><a href="#cb6-39" tabindex="-1"></a><span class="co">#&gt; $ heightweight_t1 &lt;dbl&gt; 20.1, 20.3, 20.2, 26.8, 19.3, 23.4, 21.2, 16.4, 19.4, …</span></span>
<span id="cb6-40"><a href="#cb6-40" tabindex="-1"></a><span class="co">#&gt; $ heightweight_t2 &lt;dbl&gt; 19.7, 19.9, 17.7, 27.9, 18.1, 24.3, 20.7, 16.7, 18.2, …</span></span>
<span id="cb6-41"><a href="#cb6-41" tabindex="-1"></a><span class="co">#&gt; $ bmi_t1          &lt;dbl&gt; 21.0, 21.1, 21.0, 23.0, 20.7, 22.1, 21.4, 19.6, 20.7, …</span></span>
<span id="cb6-42"><a href="#cb6-42" tabindex="-1"></a><span class="co">#&gt; $ bmi_t2          &lt;dbl&gt; 20.9, 21.0, 20.1, 23.3, 20.3, 22.3, 21.2, 19.7, 20.3, …</span></span>
<span id="cb6-43"><a href="#cb6-43" tabindex="-1"></a><span class="co">#&gt; $ cohort          &lt;chr&gt; &quot;younger&quot;, &quot;younger&quot;, &quot;younger&quot;, &quot;younger&quot;, &quot;younger&quot;,…</span></span>
<span id="cb6-44"><a href="#cb6-44" tabindex="-1"></a><span class="co">#&gt; $ zygosity        &lt;fct&gt; MZFF, MZFF, MZFF, MZFF, MZFF, MZFF, MZFF, MZFF, MZFF, …</span></span>
<span id="cb6-45"><a href="#cb6-45" tabindex="-1"></a><span class="co">#&gt; $ sex             &lt;chr&gt; &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;,…</span></span>
<span id="cb6-46"><a href="#cb6-46" tabindex="-1"></a><span class="co">#&gt; $ zyg             &lt;chr&gt; &quot;MZ&quot;, &quot;MZ&quot;, &quot;MZ&quot;, &quot;MZ&quot;, &quot;MZ&quot;, &quot;MZ&quot;, &quot;MZ&quot;, &quot;MZ&quot;, &quot;MZ&quot;, …</span></span></code></pre></div>
<p>The code structure for our plot would look like this:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> twinData_cleaned, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> height_t1, </span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>                                              <span class="at">y =</span> height_t2)) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Height Comparison between Twins&quot;</span>)</span></code></pre></div>
<p>It would produce a scatter plot comparing the height of twins with the height of twin 1 on the x-axis and the height of twin 2 on the y-axis.</p>
<p><img src="01_intro_files/figure-html/unnamed-chunk-6-1.png" width="70%" /></p>
<div id="plot-development-stages" class="section level3 tabset hasAnchor" number="1.2.1">
<h3 class="tabset hasAnchor"><span class="header-section-number">1.2.1</span> Plot Development Stages<a href="#plot-development-stages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Start with the <code>twinData_cleaned</code> data frame</strong></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> twinData_cleaned) <span class="co">#&lt;&lt;</span></span></code></pre></div>
<p><img src="01_intro_files/figure-html/twin-0-1.png" width="70%" /></p>
<p>Start with the <code>twinData_cleaned</code> data frame, <strong>map twin 1’s height to the x-axis</strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> twinData_cleaned,</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> height_t1)) <span class="co">#&lt;&lt;</span></span></code></pre></div>
<p><img src="01_intro_files/figure-html/twin-1-1.png" width="70%" /></p>
<p>Start with the <code>twinData_cleaned</code> data frame, map twin 1’s height to the x-axis, and <strong>and map twin 2’s height to the y-axis.</strong></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> twinData_cleaned,</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>( <span class="at">x =</span> height_t1,</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>                      <span class="at">y =</span> height_t2)) <span class="co">#&lt;&lt;</span></span></code></pre></div>
<p><img src="01_intro_files/figure-html/twin-2-1.png" width="70%" /></p>
<p>Start with the <code>twinData_cleaned</code> data frame, map twin 1’s height to the x-axis, and and map twin 2’s height to the y-axis. <strong>Represent each observation with a point</strong></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> twinData_cleaned,</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>( <span class="at">x =</span> height_t1,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>                      <span class="at">y =</span> height_t2)) <span class="sc">+</span> </span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="co">#&lt;&lt;</span></span></code></pre></div>
<p><img src="01_intro_files/figure-html/twin-3-1.png" width="70%" />
Start with the <code>twinData_cleaned</code> data frame, map twin 1’s height to the x-axis, and and map twin 2’s height to the y-axis. Represent each observation with a point, <strong>and map zygosity to the color of each point.</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> twinData_cleaned,</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>( <span class="at">x =</span> height_t1,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>                      <span class="at">y =</span> height_t2,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>                      <span class="at">color =</span> zyg)) <span class="sc">+</span> <span class="co">#&lt;&lt;</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="01_intro_files/figure-html/twin-4-1.png" width="70%" /></p>
<p>Start with the <code>twinData_cleaned</code> data frame, map twin 1’s height to the x-axis, and and map twin 2’s height to the y-axis. Represent each observation with a point, and map zygosity to the color of each point. <strong>Title the plot “Height Comparison between Twins”</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> twinData_cleaned,</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>( <span class="at">x =</span> height_t1,</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>                      <span class="at">y =</span> height_t2,</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>                      <span class="at">color =</span> zyg)) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Height Comparison between Twins&quot;</span>) <span class="co">#&lt;&lt;</span></span></code></pre></div>
<p><img src="01_intro_files/figure-html/twin-5-1.png" width="70%" /></p>
<p>Start with the <code>twinData_cleaned</code> data frame, map twin 1’s height to the x-axis, and and map twin 2’s height to the y-axis. Represent each observation with a point, and map zygosity to the color of each point. Title the plot “Height Comparison between Twins”, <strong>add the subtitle “by zygosity”</strong></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> twinData_cleaned,</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>( <span class="at">x =</span> height_t1,</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>                      <span class="at">y =</span> height_t2,</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>                      <span class="at">color =</span> zyg)) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Height Comparison between Twins&quot;</span>,</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;by zygosity&quot;</span>) <span class="co">#&lt;&lt;</span></span></code></pre></div>
<p><img src="01_intro_files/figure-html/twin-6-1.png" width="70%" /></p>
<p>Start with the <code>twinData_cleaned</code> data frame, map twin 1’s height to the x-axis, and and map twin 2’s height to the y-axis. Represent each observation with a point, and map zygosity to the color of each point. Title the plot “Height Comparison between Twins”, add the subtitle “by zygosity”, <strong>label the x and y axes as “Height of Twin 1 (m)” and “Height of Twin 2 (m)”, respectively</strong></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> twinData_cleaned,</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>( <span class="at">x =</span> height_t1,</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>                      <span class="at">y =</span> height_t2,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>                      <span class="at">color =</span> zyg)) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Height Comparison between Twins&quot;</span>,</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;by zygosity&quot;</span>,</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Height of Twin 1 (m)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Height of Twin 2 (m)&quot;</span>) <span class="co">#&lt;&lt;</span></span></code></pre></div>
<p><img src="01_intro_files/figure-html/twin-7-1.png" width="70%" /></p>
<p>Start with the <code>twinData_cleaned</code> data frame, map twin 1’s height to the x-axis, and and map twin 2’s height to the y-axis. Represent each observation with a point, and map zygosity to the color of each point. Title the plot “Height Comparison between Twins”, add the subtitle “by zygosity”, label the x and y axes as “Height of Twin 1 (m)” and “Height of Twin 2 (m)”, respectively , <strong>label the legend “Zygosity”</strong></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> twinData_cleaned,</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>( <span class="at">x =</span> height_t1,</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>                      <span class="at">y =</span> height_t2,</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>                      <span class="at">color =</span> zyg)) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Height Comparison between Twins&quot;</span>,</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;by zygosity&quot;</span>,</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Height of Twin 1 (m)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Height of Twin 2 (m)&quot;</span>,</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Zygosity&quot;</span>) <span class="co">#&lt;&lt;</span></span></code></pre></div>
<p><img src="01_intro_files/figure-html/twin-8-1.png" width="70%" /></p>
<p>Start with the <code>twinData_cleaned</code> data frame, map twin 1’s height to the x-axis, and and map twin 2’s height to the y-axis. Represent each observation with a point, and map zygosity to the color of each point. Title the plot “Height Comparison between Twins”, add the subtitle “by zygosity”, label the x and y axes as “Height of Twin 1 (m)” and “Height of Twin 2 (m)”, respectively , label the legend “Zygosity”, and <strong>add a caption for the data source.</strong></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> twinData_cleaned,</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>( <span class="at">x =</span> height_t1,</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>                      <span class="at">y =</span> height_t2,</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>                      <span class="at">color =</span> zyg)) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Height Comparison between Twins&quot;</span>,</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;by zygosity&quot;</span>,</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Height of Twin 1 (m)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Height of Twin 2 (m)&quot;</span>,</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Zygosity&quot;</span>,</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Source: Australian National Health and Medical Research Council Twin Registry / OpenMx package&quot;</span>) <span class="co">#&lt;&lt;</span></span></code></pre></div>
<p><img src="01_intro_files/figure-html/twin-9-1.png" width="70%" /></p>
<p>Start with the <code>twinData_cleaned</code> data frame, map twin 1’s height to the x-axis, and and map twin 2’s height to the y-axis. Represent each observation with a point, and map zygosity to the color of each point. Title the plot “Height Comparison between Twins”, add the subtitle “by zygosity”, label the x and y axes as “Height of Twin 1 (m)” and “Height of Twin 2 (m)”, respectively , label the legend “Zygosity”, and add a caption for the data source. <strong>Finally, use a discrete color scale that is designed to be perceived by viewers with common forms of color blindness.</strong></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> twinData_cleaned,</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>( <span class="at">x =</span> height_t1,</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>                      <span class="at">y =</span> height_t2,</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>                      <span class="at">color =</span> zyg)) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Height Comparison between Twins&quot;</span>,</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;by zygosity&quot;</span>,</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Height of Twin 1 (m)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Height of Twin 2 (m)&quot;</span>,</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Zygosity&quot;</span>,</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Source: Australian National Health and Medical Research Council Twin Registry / OpenMx package&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>() <span class="co">#&lt;&lt;</span></span></code></pre></div>
<p><img src="01_intro_files/figure-html/twin-10-1.png" width="70%" /></p>
<!--chapter:end:01_intro.Rmd-->
</div>
</div>
</div>
<div id="welcome-to-ggplot" class="section level1 hasAnchor" number="2">
<h1 class="hasAnchor"><span class="header-section-number">2</span> Welcome to ggplot<a href="#welcome-to-ggplot" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This chapter serves as an in-depth guide for visualizing twin study data using <code>ggplot2</code>, a component of the R <code>tidyverse</code> package. By leveraging the flexibility and power of <code>ggplot2</code>, researchers can effectively illustrate the intricate patterns often present in twin study data.</p>
<div id="math-example" class="section level2 hasAnchor" number="2.1">
<h2 class="hasAnchor"><span class="header-section-number">2.1</span> math example<a href="#math-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="math inline">\(p\)</span> is unknown but expected to be around 1/3. Standard error will be approximated</p>
<p><span class="math display">\[
SE = \sqrt(\frac{p(1-p)}{n}) \approx \sqrt{\frac{1/3 (1 - 1/3)} {300}} = 0.027
\]</span></p>
<p>You can also use math in footnotes like this<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
<p>We will approximate standard error to 0.027<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<!--chapter:end:02_descriptives.Rmd-->
</div>
</div>
<div id="descriptives-wide" class="section level1 hasAnchor" number="3">
<h1 class="hasAnchor"><span class="header-section-number">3</span> Descriptives (Wide)<a href="#descriptives-wide" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="import-data" class="section level2 hasAnchor" number="3.1">
<h2 class="hasAnchor"><span class="header-section-number">3.1</span> Import Data<a href="#import-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We’re going to use the <code>twinData</code> dataset from the <code>OpenMx</code> package. This dataset contains 3,808 pairs of Australian twins on the 12 variables.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
## ✔ dplyr     1.1.4     ✔ readr     2.1.5
## ✔ forcats   1.0.0     ✔ stringr   1.5.1
## ✔ ggplot2   3.5.1     ✔ tibble    3.2.1
## ✔ lubridate 1.9.3     ✔ tidyr     1.3.1
## ✔ purrr     1.0.2     
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">library</span>(NlsyLinks)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="fu">library</span>(discord)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="fu">library</span>(BGmisc)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="fu">library</span>(OpenMx)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;OpenMx&#39;
## 
## The following object is masked from &#39;package:BGmisc&#39;:
## 
##     vech</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">data</span>(twinData)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>df <span class="ot">&lt;-</span> twinData</span></code></pre></div>
</div>
<div id="data-structure" class="section level2 hasAnchor" number="3.2">
<h2 class="hasAnchor"><span class="header-section-number">3.2</span> Data Structure<a href="#data-structure" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">class</span>(df)</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">glimpse</span>(df)</span></code></pre></div>
<pre><code>## Rows: 3,808
## Columns: 16
## $ fam      &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18…
## $ age      &lt;int&gt; 21, 24, 21, 21, 19, 26, 23, 29, 24, 28, 29, 19, 23, 22, 23, 2…
## $ zyg      &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ part     &lt;int&gt; 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2…
## $ wt1      &lt;int&gt; 58, 54, 55, 66, 50, 60, 65, 40, 60, 76, 48, 70, 51, 53, 58, 4…
## $ wt2      &lt;int&gt; 57, 53, 50, 76, 48, 60, 65, 39, 57, 64, 51, 67, 51, 55, 57, 5…
## $ ht1      &lt;dbl&gt; 1.7000, 1.6299, 1.6499, 1.5698, 1.6099, 1.5999, 1.7500, 1.559…
## $ ht2      &lt;dbl&gt; 1.7000, 1.6299, 1.6799, 1.6499, 1.6299, 1.5698, 1.7698, 1.529…
## $ htwt1    &lt;dbl&gt; 20.0692, 20.3244, 20.2020, 26.7759, 19.2894, 23.4375, 21.2245…
## $ htwt2    &lt;dbl&gt; 19.7232, 19.9481, 17.7154, 27.9155, 18.0662, 24.3418, 20.7476…
## $ bmi1     &lt;dbl&gt; 20.9943, 21.0828, 21.0405, 23.0125, 20.7169, 22.0804, 21.3861…
## $ bmi2     &lt;dbl&gt; 20.8726, 20.9519, 20.1210, 23.3043, 20.2583, 22.3454, 21.2270…
## $ cohort   &lt;chr&gt; &quot;younger&quot;, &quot;younger&quot;, &quot;younger&quot;, &quot;younger&quot;, &quot;younger&quot;, &quot;young…
## $ zygosity &lt;fct&gt; MZFF, MZFF, MZFF, MZFF, MZFF, MZFF, MZFF, MZFF, MZFF, MZFF, M…
## $ age1     &lt;int&gt; 21, 24, 21, 21, 19, 26, 23, 29, 24, 28, 29, 19, 23, 22, 23, 2…
## $ age2     &lt;int&gt; 21, 24, 21, 21, 19, 26, 23, 29, 24, 28, 29, 19, 23, 22, 23, 2…</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">sex =</span> </span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>                      <span class="fu">case_when</span>(zygosity <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;MZFF&quot;</span>,<span class="st">&quot;DZFF&quot;</span>) <span class="sc">~</span> <span class="st">&quot;F&quot;</span>, </span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>                                zygosity <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;MZMM&quot;</span>,<span class="st">&quot;DZMM&quot;</span>) <span class="sc">~</span> <span class="st">&quot;M&quot;</span>,</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;OS&quot;</span>),</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>                    <span class="at">zyg =</span> <span class="fu">case_when</span>(zygosity <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;MZFF&quot;</span>,<span class="st">&quot;MZMM&quot;</span>) <span class="sc">~</span> <span class="st">&quot;MZ&quot;</span>, </span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>                                    zygosity <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;DZFF&quot;</span>,<span class="st">&quot;DZMM&quot;</span>,<span class="st">&quot;DZOS&quot;</span>) <span class="sc">~</span> <span class="st">&quot;DZ&quot;</span>,</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>                                <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span> ))</span></code></pre></div>
</div>
<div id="summary-statistics" class="section level2 hasAnchor" number="3.3">
<h2 class="hasAnchor"><span class="header-section-number">3.3</span> Summary Statistics<a href="#summary-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="numeric-variables" class="section level3 hasAnchor" number="3.3.1">
<h3 class="hasAnchor"><span class="header-section-number">3.3.1</span> Numeric Variables<a href="#numeric-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="co"># Calculate summary statistics</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="fu">list</span>(</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>    <span class="at">mean =</span> <span class="sc">~</span><span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>    <span class="at">sd =</span> <span class="sc">~</span><span class="fu">sd</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>    <span class="at">median =</span> <span class="sc">~</span><span class="fu">median</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>    <span class="at">IQR =</span> <span class="sc">~</span><span class="fu">IQR</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>  ), <span class="at">.names =</span> <span class="st">&quot;{col}_{fn}&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">everything</span>(),</span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;variable&quot;</span>, <span class="st">&quot;statistic&quot;</span>),</span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a>    <span class="at">names_sep =</span> <span class="st">&quot;_&quot;</span></span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a>    <span class="at">names_from =</span> statistic,</span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a>    <span class="at">values_from =</span> value</span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a>  )</span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a></span>
<span id="cb29-19"><a href="#cb29-19" tabindex="-1"></a>summary_stats</span></code></pre></div>
<pre><code>## # A tibble: 13 × 5
##    variable    mean        sd  median      IQR
##    &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
##  1 fam      1904.   1099.     1904.   1904.   
##  2 age        34.5    14.2      30      19    
##  3 part        1.93    0.265     2       0    
##  4 wt1        62.2    10.9      60      15    
##  5 wt2        65.6    12.2      65      16    
##  6 ht1         1.66    0.0896    1.65    0.130
##  7 ht2         1.69    0.0990    1.7     0.140
##  8 htwt1      22.5     3.16     21.9     3.84 
##  9 htwt2      22.8     3.19     22.3     3.78 
## 10 bmi1       21.7     0.940    21.6     1.21 
## 11 bmi2       21.8     0.939    21.7     1.18 
## 12 age1       34.5    14.2      30      19    
## 13 age2       34.5    14.2      30      19</code></pre>
</div>
</div>
<div id="frequency-tables" class="section level2 hasAnchor" number="3.4">
<h2 class="hasAnchor"><span class="header-section-number">3.4</span> Frequency Tables<a href="#frequency-tables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="co"># Counting &#39;zygosity&#39; and calculating percentages</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>zygosity_summary <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>  <span class="fu">count</span>(zyg, <span class="at">name =</span> <span class="st">&quot;count&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">category =</span> zyg) <span class="sc">%&gt;%</span>  <span class="co"># Renaming the column for clarity</span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="st">&quot;zygosity&quot;</span>)  <span class="co"># Adding a descriptor column for the variable</span></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a><span class="co"># Counting &#39;sex&#39; and calculating percentages</span></span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>sex_summary <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>  <span class="fu">count</span>(sex, <span class="at">name =</span> <span class="st">&quot;count&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">category =</span> sex) <span class="sc">%&gt;%</span>  <span class="co"># Renaming the column for clarity</span></span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="st">&quot;sex&quot;</span>)  <span class="co"># Adding a descriptor column for the variable</span></span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a></span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a><span class="co"># Combining both summaries into a single dataframe</span></span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a>combined_summary <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(zygosity_summary, sex_summary) <span class="sc">%&gt;%</span></span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a>  <span class="fu">select</span>(variable, category, <span class="fu">everything</span>())  <span class="co"># Reordering columns for clarity</span></span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a></span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a>combined_summary</span></code></pre></div>
<pre><code>##   variable category count percentage
## 1 zygosity       DZ  2009   52.75735
## 2 zygosity       MZ  1799   47.24265
## 3      sex        F  1983   52.07458
## 4      sex        M   919   24.13340
## 5      sex       OS   906   23.79202</code></pre>
<p>What if you want to examine effects by cohort? You can use the <code>group_by</code> function to group the data by cohort and then calculate the summary statistics for each cohort.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a><span class="co"># Grouping by &#39;cohort&#39; and calculating summary statistics for each group across values that are numeric</span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>df_summary <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>    <span class="fu">group_by</span>(cohort) <span class="sc">%&gt;%</span></span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="fu">list</span>(</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>        <span class="at">mean =</span> <span class="sc">~</span><span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a>        <span class="at">sd =</span> <span class="sc">~</span><span class="fu">sd</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a>        <span class="at">median =</span> <span class="sc">~</span><span class="fu">median</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a>        <span class="at">IQR =</span> <span class="sc">~</span><span class="fu">IQR</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a>    ), <span class="at">.names =</span> <span class="st">&quot;{.col}_{.fn}&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a>    <span class="co"># Ensure only statistic columns are being pivoted</span></span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a>        <span class="at">cols =</span> <span class="sc">-</span>cohort,  <span class="co"># Exclude &#39;cohort&#39; from pivoting</span></span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a>        <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;variable&quot;</span>, <span class="st">&quot;statistic&quot;</span>),</span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a>        <span class="at">names_sep =</span> <span class="st">&quot;_&quot;</span></span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a>    )</span>
<span id="cb33-18"><a href="#cb33-18" tabindex="-1"></a><span class="co"># lock in the variable order</span></span>
<span id="cb33-19"><a href="#cb33-19" tabindex="-1"></a>variable_order <span class="ot">&lt;-</span> <span class="fu">unique</span>(df_summary<span class="sc">$</span>variable)</span>
<span id="cb33-20"><a href="#cb33-20" tabindex="-1"></a></span>
<span id="cb33-21"><a href="#cb33-21" tabindex="-1"></a>df_summary <span class="ot">&lt;-</span> df_summary  <span class="sc">%&gt;%</span> </span>
<span id="cb33-22"><a href="#cb33-22" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(</span>
<span id="cb33-23"><a href="#cb33-23" tabindex="-1"></a>        <span class="at">names_from =</span> statistic,</span>
<span id="cb33-24"><a href="#cb33-24" tabindex="-1"></a>        <span class="at">values_from =</span> value,</span>
<span id="cb33-25"><a href="#cb33-25" tabindex="-1"></a>        <span class="at">values_fn =</span> <span class="fu">list</span>(<span class="at">value =</span> mean)  <span class="co"># Aggregate if necessary</span></span>
<span id="cb33-26"><a href="#cb33-26" tabindex="-1"></a>    )</span>
<span id="cb33-27"><a href="#cb33-27" tabindex="-1"></a></span>
<span id="cb33-28"><a href="#cb33-28" tabindex="-1"></a>df_summary  <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">factor</span>(variable, <span class="at">levels =</span> variable_order)) <span class="sc">%&gt;%</span></span>
<span id="cb33-29"><a href="#cb33-29" tabindex="-1"></a>    <span class="fu">arrange</span>(variable, cohort)</span></code></pre></div>
<pre><code>## # A tibble: 26 × 6
##    cohort  variable    mean      sd median   IQR
##    &lt;chr&gt;   &lt;fct&gt;      &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
##  1 older   fam      2859    548.      2859   949
##  2 younger fam       955    551.       955   954
##  3 older   age        45.4   12.2       42    19
##  4 younger age        23.5    3.66      23     7
##  5 older   part        1.95   0.224      2     0
##  6 younger part        1.92   0.299      2     0
##  7 older   wt1        63.8   11.2       62    15
##  8 younger wt1        60.5   10.3       59    14
##  9 older   wt2        67.0   12.7       66    19
## 10 younger wt2        64.1   11.6       64    17
## # ℹ 16 more rows</code></pre>
<p>What about descriptives by zygosity and sex?</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a><span class="co"># Grouping by &#39;zyg,sex&#39; and calculating summary statistics for each group</span></span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>df_summary <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>    <span class="fu">group_by</span>(zyg,sex) <span class="sc">%&gt;%</span></span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="fu">list</span>(</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>        <span class="at">mean =</span> <span class="sc">~</span><span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>        <span class="at">sd =</span> <span class="sc">~</span><span class="fu">sd</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>        <span class="at">median =</span> <span class="sc">~</span><span class="fu">median</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>        <span class="at">IQR =</span> <span class="sc">~</span><span class="fu">IQR</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a>    ), <span class="at">.names =</span> <span class="st">&quot;{.col}_{.fn}&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a>    <span class="co"># Ensure only statistic columns are being pivoted</span></span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a>        <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(zyg,sex),  <span class="co"># Exclude &#39;zygosity&#39; from pivoting</span></span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a>        <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;variable&quot;</span>, <span class="st">&quot;statistic&quot;</span>),</span>
<span id="cb35-16"><a href="#cb35-16" tabindex="-1"></a>        <span class="at">names_sep =</span> <span class="st">&quot;_&quot;</span></span>
<span id="cb35-17"><a href="#cb35-17" tabindex="-1"></a>    )</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;zyg&#39;. You can override using the `.groups`
## argument.</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="co"># lock in the variable order</span></span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>variable_order <span class="ot">&lt;-</span> <span class="fu">unique</span>(df_summary<span class="sc">$</span>variable)</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>df_summary <span class="ot">&lt;-</span> df_summary  <span class="sc">%&gt;%</span> </span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a>        <span class="at">names_from =</span> statistic,</span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a>        <span class="at">values_from =</span> value,</span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a>        <span class="at">values_fn =</span> <span class="fu">list</span>(<span class="at">value =</span> mean)  <span class="co"># Aggregate if necessary</span></span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a>    )</span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a>df_summary  <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">factor</span>(variable, <span class="at">levels =</span> variable_order)) <span class="sc">%&gt;%</span></span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a>    <span class="fu">arrange</span>(variable,zyg,sex)</span></code></pre></div>
<pre><code>## # A tibble: 65 × 7
## # Groups:   zyg [2]
##    zyg   sex   variable   mean     sd median   IQR
##    &lt;chr&gt; &lt;chr&gt; &lt;fct&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
##  1 DZ    F     fam      2109.  1029.   2891  2048 
##  2 DZ    M     fam      2144.  1009.   1370. 2042.
##  3 DZ    OS    fam      2509.   980.   1852. 1956.
##  4 MZ    F     fam      1338.   992.   1956. 1956.
##  5 MZ    M     fam      1750.  1010.   2583  2013 
##  6 DZ    F     age        35.4   14.3    32    20 
##  7 DZ    M     age        32.3   13.9    28    16 
##  8 DZ    OS    age        32.9   13.9    28    17 
##  9 MZ    F     age        35.7   14.3    32    21 
## 10 MZ    M     age        34.4   14.1    31    18 
## # ℹ 55 more rows</code></pre>
</div>
<div id="plots" class="section level2 hasAnchor" number="3.5">
<h2 class="hasAnchor"><span class="header-section-number">3.5</span> Plots<a href="#plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Histograms and scatter plots to visualize distributions and relationships.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> wt1)) <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">30</span>, <span class="at">fill=</span><span class="st">&quot;blue&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;weight&quot;</span>, <span class="at">y=</span><span class="st">&quot;Frequency&quot;</span>, <span class="at">title=</span><span class="st">&quot;Distribution of weight for Twin 1&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 97 rows containing non-finite outside the scale range
## (`stat_bin()`).</code></pre>
<p><img src="03_wide_files/figure-html/data-viz-1.png" width="768" /></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="co"># Basic Scatter Plot of weight of Twin 1 vs. weight of Twin 2</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>wt1, <span class="at">y=</span>wt2, <span class="at">color=</span>zyg)) <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span>.<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Weight of Twin 1&quot;</span>, </span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Weight of Twin 2&quot;</span>, </span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Scatterplot of weight by Zygosity&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;virdis&quot;</span>,</span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a>                        <span class="at">begin =</span> <span class="fl">0.1</span>,<span class="at">end=</span>.<span class="dv">85</span>) <span class="sc">+</span></span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## Warning in viridisLite::viridis(n, alpha, begin, end, direction, option):
## Option &#39;virdis&#39; does not exist. Defaulting to &#39;viridis&#39;.</code></pre>
<pre><code>## Warning: Removed 173 rows containing missing values or values outside the scale range
## (`geom_point()`).</code></pre>
<p><img src="03_wide_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Adding a regression line to the scatter plot.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 173 rows containing non-finite outside the scale range
## (`stat_smooth()`).</code></pre>
<pre><code>## Warning in viridisLite::viridis(n, alpha, begin, end, direction, option):
## Option &#39;virdis&#39; does not exist. Defaulting to &#39;viridis&#39;.</code></pre>
<pre><code>## Warning: Removed 173 rows containing missing values or values outside the scale range
## (`geom_point()`).</code></pre>
<p><img src="03_wide_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a><span class="fu">library</span>(ggExtra)</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a><span class="co"># Create marginal density plots for x and y axes</span></span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a>p_x <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> wt1, <span class="at">fill =</span> zyg)) <span class="sc">+</span></span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb49-9"><a href="#cb49-9" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;viridis&quot;</span>, <span class="at">begin =</span> <span class="fl">0.1</span>, <span class="at">end =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb49-10"><a href="#cb49-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb49-11"><a href="#cb49-11" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb49-12"><a href="#cb49-12" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb49-13"><a href="#cb49-13" tabindex="-1"></a></span>
<span id="cb49-14"><a href="#cb49-14" tabindex="-1"></a>p_x</span></code></pre></div>
<pre><code>## Warning: Removed 97 rows containing non-finite outside the scale range
## (`stat_density()`).</code></pre>
<p><img src="03_wide_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a>p_y <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> wt2, <span class="at">fill =</span> zyg)) <span class="sc">+</span></span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;viridis&quot;</span>, <span class="at">begin =</span> <span class="fl">0.1</span>, <span class="at">end =</span> <span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a> p_y</span></code></pre></div>
<pre><code>## Warning: Removed 86 rows containing non-finite outside the scale range
## (`stat_density()`).</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="co"># with marginal histogram</span></span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggMarginal</span>(p, <span class="at">type=</span><span class="st">&quot;histogram&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in viridisLite::viridis(n, alpha, begin, end, direction, option):
## Option &#39;virdis&#39; does not exist. Defaulting to &#39;viridis&#39;.</code></pre>
<pre><code>## Warning in viridisLite::viridis(n, alpha, begin, end, direction, option):
## Option &#39;virdis&#39; does not exist. Defaulting to &#39;viridis&#39;.</code></pre>
<pre><code>## Warning: Removed 173 rows containing missing values or values outside the scale range
## (`geom_point()`).</code></pre>
<pre><code>## Warning in viridisLite::viridis(n, alpha, begin, end, direction, option):
## Option &#39;virdis&#39; does not exist. Defaulting to &#39;viridis&#39;.</code></pre>
<pre><code>## Warning: Removed 173 rows containing missing values or values outside the scale range
## (`geom_point()`).</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="03_wide_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="co"># marginal density</span></span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggMarginal</span>(p, <span class="at">type=</span><span class="st">&quot;density&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in viridisLite::viridis(n, alpha, begin, end, direction, option):
## Option &#39;virdis&#39; does not exist. Defaulting to &#39;viridis&#39;.
## Warning in viridisLite::viridis(n, alpha, begin, end, direction, option):
## Option &#39;virdis&#39; does not exist. Defaulting to &#39;viridis&#39;.</code></pre>
<pre><code>## Warning: Removed 173 rows containing missing values or values outside the scale range
## (`geom_point()`).</code></pre>
<pre><code>## Warning in viridisLite::viridis(n, alpha, begin, end, direction, option):
## Option &#39;virdis&#39; does not exist. Defaulting to &#39;viridis&#39;.</code></pre>
<pre><code>## Warning: Removed 173 rows containing missing values or values outside the scale range
## (`geom_point()`).</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a>p2</span></code></pre></div>
<p><img src="03_wide_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="co"># marginal boxplot</span></span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggMarginal</span>(p, <span class="at">type=</span><span class="st">&quot;boxplot&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in viridisLite::viridis(n, alpha, begin, end, direction, option):
## Option &#39;virdis&#39; does not exist. Defaulting to &#39;viridis&#39;.
## Warning in viridisLite::viridis(n, alpha, begin, end, direction, option):
## Option &#39;virdis&#39; does not exist. Defaulting to &#39;viridis&#39;.</code></pre>
<pre><code>## Warning: Removed 173 rows containing missing values or values outside the scale range
## (`geom_point()`).</code></pre>
<pre><code>## Warning in viridisLite::viridis(n, alpha, begin, end, direction, option):
## Option &#39;virdis&#39; does not exist. Defaulting to &#39;viridis&#39;.</code></pre>
<pre><code>## Warning: Removed 173 rows containing missing values or values outside the scale range
## (`geom_point()`).</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a>p3</span></code></pre></div>
<p><img src="03_wide_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="correlation-matrix" class="section level2 hasAnchor" number="3.6">
<h2 class="hasAnchor"><span class="header-section-number">3.6</span> Correlation Matrix<a href="#correlation-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="co"># Calculate the correlation matrix</span></span></code></pre></div>
<!--chapter:end:03_wide.Rmd-->
</div>
</div>
<div id="applications" class="section level1 hasAnchor" number="4">
<h1 class="hasAnchor"><span class="header-section-number">4</span> Applications<a href="#applications" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Some <em>significant</em> applications are demonstrated in this chapter.</p>
<div id="example-one" class="section level2 hasAnchor" number="4.1">
<h2 class="hasAnchor"><span class="header-section-number">4.1</span> Example one<a href="#example-one" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="example-two" class="section level2 hasAnchor" number="4.2">
<h2 class="hasAnchor"><span class="header-section-number">4.2</span> Example two<a href="#example-two" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:04_long.Rmd-->
</div>
</div>
<div id="final-words" class="section level1 hasAnchor" number="5">
<h1 class="hasAnchor"><span class="header-section-number">5</span> Final Words<a href="#final-words" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!-- I leaned into the cheesiness -->
<p>Throughout this document, we have embarked on an exploration of the evolving landscape of data visualization in the field of behavior genetics. By revisiting historical methodologies and embracing modern techniques, we have uncovered a rich tapestry of visual tools that enhance our understanding and communication of genetic data. The atlas of <code>ggplot2</code> visualizations presented here not only serves as a practical guide but also as an inspiration for researchers to think creatively about how data can be visualized more effectively.</p>
<!--chapter:end:05_summary.Rmd-->
</div>
<div id="references" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">References<a href="#references" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:06_references.Rmd-->
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Wright1920" class="csl-entry">
Wright, S. 1920. <span>“The Relative Importance of Heredity and Environment in Determining the Piebald Pattern of Guinea-Pigs.”</span> <em>Proceedings of the National Academy of Sciences</em> 6 (6): 320–32. <a href="https://doi.org/10.1073/pnas.6.6.320">https://doi.org/10.1073/pnas.6.6.320</a>.
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>where we mention <span class="math inline">\(p = \frac{a}{b}\)</span><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p><span class="math inline">\(p\)</span> is unknown but expected to be around 1/3. Standard error will be approximated</p>
<p><span class="math display">\[
SE = \sqrt(\frac{p(1-p)}{n}) \approx \sqrt{\frac{1/3 (1 - 1/3)} {300}} = 0.027
\]</span><a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
